---
title: Django>model
date: 2022-03-08 09:04:47
categories:
- Django
tags:
- Django
---

# Modelâ­

* ë‹¨ì¼í•œ ë°ì´í„°ì— ëŒ€í•œ ì •ë³´ë¥¼ ê°€ì§
  * ì‚¬ìš©ìê°€ ì €ì¥í•˜ëŠ” ë°ì´í„°ë“¤ì˜ í•„ìˆ˜ì ì¸ í•„ë“œë“¤ê³¼ ë™ì‘ë“¤ì„ í¬í•¨
* ì €ì¥ëœ ë°ì´í„°ë² ì´ìŠ¤ì˜ êµ¬ì¡° (layout)
* djangoëŠ” modelì„ í†µí•´ ë°ì´í„°ì— ì ‘ì†í•˜ê³  ê´€ë¦¬
* ì¼ë°˜ì ìœ¼ë¡œ ê°ê°ì˜ modelì€ í•˜ë‚˜ì˜ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì— ë§¤í•‘ ë¨

## Database

* ë°ì´í„°ë² ì´ìŠ¤(DB)
  * ì²´ê³„í™”ëœ ë°ì´í„°ì˜ ëª¨ì„
* ì¿¼ë¦¬ (Query)
  * ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ê¸° ìœ„í•œ ëª…ë ¹ì–´
  * ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ê±°ë‚˜ ì¡°ì‘í•˜ëŠ” ëª…ë ¹ì–´
  * "Queryë¥¼ ë‚ ë¦°ë‹¤" -> DBë¥¼ ì¡°ì‘í•œë‹¤.
* ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬ ì‹œìŠ¤í…œ ì¢…ë¥˜
  * MySQL
  * ORACLE db
  * MariaDB
  * PostgreSQL

## Databaseì˜ ê¸°ë³¸ êµ¬ì¡°

* ìŠ¤í‚¤ë§ˆ (Shcema)
  * ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìë£Œì˜ êµ¬ì¡°, í‘œí˜„ë°©ë²•, ê´€ê³„ ë“±ì„ ì •ì˜í•œ êµ¬ì¡°(structure)
  * ë°ì´í„°ë°ì´ìŠ¤ì˜ êµ¬ì¡°ì™€ ì œì•½ ì¡°ê±´(ìë£Œì˜ êµ¬ì¡°, í‘œí˜„ë°©ë²•, ê´€ê³„)ì— ê´€ë ¨í•œ ì „ë°˜ì ì¸ ëª…ì„¸ë¥¼ ê¸°ìˆ í•œ ê²ƒ
  * ê´€ê³„ (1:N, N:N,...)
  
* í…Œì´ë¸”(table)
  * ì—´ê³¼ í–‰ì˜ ëª¨ë¸ì„ ì‚¬ìš©í•´ ì¡°ì§ëœ ë°ì´í„° ìš”ì†Œë“¤ì˜ ì§‘í•©. SQL ë°ì´í„°ë² ì´ìŠ¤ì—ì„œëŠ” í…Œì´ë¸”ì„ `ê´€ê³„`ë¼ê³ ë„ í•œë‹¤.
  * ì—´(column) : í•„ë“œ(field) or ì†ì„±
    * ê° ì—´ì—ëŠ” ê³ ìœ í•œ ë°ì´í„° í˜•ì‹ì´ ì§€ì •ëœë‹¤.
    * INTEGER, TEXT, NULL ë“±
  * í–‰(row) : ë ˆì½”ë“œ(record) or íŠœí”Œ
    * í…Œì´ë¸”ì˜ ë°ì´í„°ëŠ” í–‰ì— ì €ì¥ëœë‹¤.

* PK (ê¸°ë³¸í‚¤)â­
  * ê° í–‰ì˜ ê³ ìœ ê°’ìœ¼ë¡œ Primary Keyë¡œ ë¶ˆë¦°ë‹¤.
  * ë°˜ë“œì‹œ ì„¤ì •í•˜ì—¬ì•¼í•˜ë©°, ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬ ë° ê´€ê³„ ì„¤ì • ì‹œ ì£¼ìš”í•˜ê²Œ í™œìš©ëœë‹¤.
  * `djangoëŠ” idê°€ ê³§ PKì´ë‹¤.`

![image-20220308123118143](image-20220308123118143.png)

## Model

* ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°ì´í„°ë¥¼ **êµ¬ì¡°í™”**í•˜ê³  **ì¡°ì‘**í•˜ê¸° ìœ„í•œ ë„êµ¬â­

# ORMâ­

* Object-Relational-Mapping
* ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ í˜¸í™˜ë˜ì§€ ì•ŠëŠ” ìœ í˜•ì˜ ì‹œìŠ¤í…œ ê°„(Django-SQL)ì— ë°ì´í„°ë¥¼ ë³€í™˜í•˜ëŠ” í”„ë¡œê·¸ë˜ë° ê¸°ìˆ 
* OOPí”„ë¡œê·¸ë˜ë°ì—ì„œ RDBMSì„ ì—°ë™í•  ë•Œ, ë°ì´í„°ë² ì´ìŠ¤ì™€ ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ê°„ì˜ í˜¸í™˜ë˜ì§€ ì•ŠëŠ” ë°ì´í„°ë¥¼ ë³€í™˜í•˜ëŠ” í”„ë¡œê·¸ë˜ë° ê¸°ë²•
* DjangoëŠ” ë‚´ì¥ Django ORM ì„ ì‚¬ìš©í•¨

![image-20220317233751117](image-20220317233751117.png)

## ORMì˜ ì¥ì ê³¼ ë‹¨ì â­

* ì¥ì 
  * SQLì„ ì˜ ì•Œì§€ ëª»í•´ë„ DB ì¡°ì‘ì´ ê°€ëŠ¥
  * SQLì˜ ì ˆì°¨ì  ì ‘ê·¼ì´ ì•„ë‹Œ ê°ì²´ì§€í–¥ì  ì ‘ê·¼ìœ¼ë¡œ ì¸í•œ ë†’ì€ ìƒì‚°ì„±
* ë‹¨ì 
  * ORM ë§Œìœ¼ë¡œ ì™„ì „í•œ ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•˜ê¸° ì–´ë ¤ìš´ ê²½ìš°ê°€ ìˆìŒ
* í˜„ëŒ€ ì›¹ í”„ë ˆì„ì›Œí¬ì˜ ìš”ì ì€ ì›¹ ê°œë°œì˜ ì†ë„ë¥¼ ë†’ì´ëŠ” ê²ƒ (***ìƒì‚°ì„±***)
  * ê°œë°œ ì†ë„ëŠ” ORMì„ ì“°ëŠ” ê²ƒì´ ë” ë¹ ë¥´ì§€ë§Œ, ì„œë¹„ìŠ¤ì˜ ì†ë„ëŠ” SQLì„ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” ë¹ ë¥´ë‹¤.
  * ì„œë¹„ìŠ¤ ëŸ°ì¹­ ìì²´ëŠ” ORMì„ ì‚¬ìš©í•˜ê³  ì„œë¹„ìŠ¤ë¥¼ ìš´ì˜í•˜ë©° ì‹œê°„ì´ ë§ì´ê±¸ë¦¬ëŠ” ë¶€ë¶„ì„ SQLë¡œ ìµœì í™” í•˜ëŠ” ë°©ë²•ì„ ë§ì´ ì‚¬ìš©í•œë‹¤.
* ì™œ ORM ì„ ì‚¬ìš©í• ê¹Œ?
  * **DBë¥¼ ê°ì²´ë¡œ ì¡°ì‘í•˜ê¸° ìœ„í•´ ORMì„ ì‚¬ìš©í•œë‹¤.**

## model.py ì‘ì„±

```python
# articles/models.py
class Article(models.Model):
    title = models.CharField(max_length=10) # ê¸¸ì´ì œí•œ ìˆëŠ” ê²½ìš° CharField ì‚¬ìš©
    content = models.TextField() # ê¸¸ì´ì œí•œ ì—†ëŠ” ê²½ìš° TextField ì‚¬ìš©
```

* ê° ëª¨ë¸ì€ django.db.models.Model í´ë˜ìŠ¤ì˜ ì„œë¸Œ í´ë˜ìŠ¤ë¡œ í‘œí˜„
  
  * django.db.models.Model ëª¨ë“ˆì˜ Model í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ìŒ
  
* models ëª¨ë“ˆì„ í†µí•´ ì–´ë– í•œ íƒ€ì…ì˜ DB ì»¬ëŸ¼ì„ ì •ì˜í•  ê²ƒì¸ì§€ ì •ì˜

  * titleê³¼ contentëŠ” ëª¨ë¸ì˜ í•„ë“œë¥¼ ë‚˜íƒ€ëƒ„

  * ê° í•„ë“œëŠ” í´ë˜ìŠ¤ ì†ì„±ìœ¼ë¡œ ì§€ì •ë˜ì–´ ìˆìœ¼ë©°, ê° ì†ì„±ì€ ê° ë°ì´í„°ë² ì´ìŠ¤ì˜ ì—´ì— ë§¤í•‘

> Model ëª… ì •í• ë• ë‹¨ìˆ˜í˜•ìœ¼ë¡œ ìƒì„±í•œë‹¤. Djangoì—ì„œ ìë™ìœ¼ë¡œ ë³µìˆ˜í˜•ì„ ë¶™ì—¬ì„œ ê´€ë¦¬í•´ì£¼ê¸° ë•Œë¬¸ì´ë‹¤.

## ì‚¬ìš© ëª¨ë¸ í•„ë“œâ­

* `CharField(max_length=None, **options)`

  * ê¸¸ì´ì˜ ì œí•œì´ ìˆëŠ” ë¬¸ìì—´ì„ ë„£ì„ ë•Œ ì‚¬ìš©

  * CharFieldì˜ max_lengthëŠ” í•„ìˆ˜ ì¸ì

  * **í•„ë“œì˜ ìµœëŒ€ ê¸¸ì´(ë¬¸ì)**, ë°ì´í„°ë² ì´ìŠ¤ ë ˆë²¨ê³¼ Djangoì˜ ìœ íš¨ì„± ê²€ì‚¬(ê°’ì„ ê²€ì¦í•˜ëŠ” ê²ƒ)ì—ì„œ í™œìš©

* `TextField(**options)`
  * ê¸€ìì˜ ìˆ˜ê°€ ë§ì„ ë•Œ ì‚¬ìš©
  * max_length ì˜µì…˜ ì‘ì„± ì‹œ ìë™ ì–‘ì‹ í•„ë“œì¸ textarea ìœ„ì ¯ì— ë°˜ì˜ì€ ë˜ì§€ë§Œ ëª¨ë¸ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ìˆ˜ì¤€ì—ëŠ” ì ìš©ë˜ì§€ ì•ŠìŒ
    * max_length ì‚¬ìš©ì€ CharFieldì—ì„œ ì‚¬ìš©í•´ì•¼ í•¨

# Migrationsâ­â­â­

* djangoê°€ modelì— ìƒê¸´ ë³€í™”ë¥¼ DBì— ë°˜ì˜í•˜ëŠ” ë°©ë²•

## commandsâ­â­

* ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ ë° DB ìŠ¤í‚¤ë§ˆë¥¼ ë‹¤ë£¨ê¸° ìœ„í•œ ëª‡ê°€ì§€ ëª…ë ¹ì–´ (`python manage.py [command]`)

  * `makemigrations`

    * modelì„ ë³€ê²½í•œ ê²ƒì— ê¸°ë°˜í•œ ìƒˆë¡œìš´ ë§ˆì´ê·¸ë ˆì´ì…˜(like ì„¤ê³„ë„)ì„ ë§Œë“¤ ë•Œ ì‚¬ìš©
    * 'migrations/0001_initial.py' ìƒì„± í™•ì¸

  * `migrate`

    * ë§ˆì´ê·¸ë ˆì´ì…˜ì„ DBì— ë°˜ì˜í•˜ê¸° ìœ„í•´ ì‚¬ìš©
    * ì„¤ê³„ë„ë¥¼ ì‹¤ì œ DBì— ë°˜ì˜í•˜ëŠ” ê³¼ì •
    * ëª¨ë¸ì—ì„œì˜ ë³€ê²½ ì‚¬í•­ë“¤ê³¼ DBì˜ ìŠ¤í‚¤ë§ˆê°€ ë™ê¸°í™”ë¥¼ ì´ë£¸
    * 0001_initial.py ì„¤ê³„ë„ë¥¼ ì‹¤ì œ DBì— ë°˜ì˜

  * `sqlmigrate`

    * `python manage.py sqlmigrate app_name 0001`â­
    * ë§ˆì´ê·¸ë ˆì´ì…˜ì— ëŒ€í•œ SQL êµ¬ë¬¸ì„ ë³´ê¸° ìœ„í•´ ì‚¬ìš©
    * í•´ë‹¹ migrations ì„¤ê³„ë„ê°€ SQL ë¬¸ìœ¼ë¡œ ì–´ë–»ê²Œ í•´ì„ë˜ì–´ ë™ì‘í•  ì§€ ë¯¸ë¦¬ í™•ì¸í•  ìˆ˜ ìˆìŒ

  * `showmigrations`

    * í”„ë¡œì íŠ¸ ì „ì²´ì˜ ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒíƒœë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ì‚¬ìš©
    * migrations ì„¤ê³„ë„ë“¤ì´ migrate ëëŠ”ì§€ ì•ˆëëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŒ

    

## ì¶”ê°€ ëª¨ë¸ í•„ë“œ ì‘ì„±

### ì‹¤ìŠµ

```python
# articles/models.py

class Article(models.Model):
    created_at = models.DateTimeField(auto_now_add=True) 
    # auto_now_add ë°ì´í„°ê°€ ìƒì„±ë  ë•Œ ì‹œê°„ì„ ìë™ìœ¼ë¡œ ì €ì¥
    updated_at = models.DateTimeField(auto_now=True) 
    # auto_now í˜„ì¬ ì‹œê°„ì„ ìë™ìœ¼ë¡œ ì €ì¥

## ì°¸ê³  ## 
# ë‹¤ë¥¸ í•„ë“œë“¤ì— ëŒ€í•´ì„œ default ê°’ì„ ì„¤ì •í•˜ëŠ” ëŒ€ì‹ 
# í•„ë“œì—´ì„ ë¹„ì›Œë‘ëŠ” ê²ƒì„ í—ˆìš©í•œë‹¤ëŠ” ì˜ë¯¸ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •ê°€ëŠ¥í•˜ë‹¤.
# age = models.IntegerField(null=True)
# null=True : (NULL)
# blank=True : ('')
```

ëª¨ë¸ì—ì„œ í•„ë“œì •ë³´ ìˆ˜ì •ë˜ë©´ makemigrations ì§„í–‰

```bash
$ python manage.py makemigrations
You are trying to add the field 'created_at' with 'auto_now_add=True' to student without a default; the database needs something to populate existing rows.

 1) Provide a one-off default now (will be set on all existing rows)
 2) Quit, and let me add a default in models.py
Select an option:
```

í…Œì´ë¸”ì„ ë§Œë“¤ ë•Œ created_at í•„ë“œì— ëŒ€í•œ default ê°’ì´ ì—†ì–´ì„œ ì„ íƒí•˜ë„ë¡ bashì— ì¶œë ¥ë¨â­â­

* 1 : djangoì—ì„œ ì§€ê¸ˆ ë°”ë¡œ ê¸°ë³¸ê°’ì„ ì„¤ì •í•´ì¤Œ
* 2 : makemigrations ì¢…ë£Œí•˜ê³  pyíŒŒì¼ì—ì„œ ì§ì ‘ default ê°’ ì„¤ì •í•¨



### DataField's optionsâ­â­â­

* `auto_now_add`
  * ìµœì´ˆ ìƒì„± ì¼ì
  * Django ORM ì´ ìµœì´ˆ insert (í…Œì´ë¸”ì— ë°ì´í„° ì…ë ¥)ì‹œì—ë§Œ í˜„ì¬ ë‚ ì§œì™€ ì‹œê°„ìœ¼ë¡œ ê°±ì‹ 
    (í…Œì´ë¸”ì— ì–´ë–¤ ê°’ì„ ìµœì´ˆë¡œ ë„£ì„ ë•Œ)
* `auto_now`
  * ìµœì¢… ìˆ˜ì • ì¼ì
  * Django ORMì´ saveë¥¼ í•  ë•Œë§ˆë‹¤ í˜„ì¬ ë‚ ì§œì™€ ì‹œê°„ìœ¼ë¡œ ê°±ì‹ 
* DateTimeFieldê°€ ì•„ë‹Œ DataFieldì˜ optionsë¥¼ í™•ì¸í•œ ì´ìœ 
  * DataTimeFieldëŠ” DateFieldì™€ ë™ì¼í•œ ì¶”ê°€ ì¸ì(extra argument)ë¥¼ ì‚¬ìš©í•¨
  * DataTimeFieldëŠ” DateFieldì˜ ì„œë¸Œ í´ë˜ìŠ¤

## ë°˜ë“œì‹œ ê¸°ì–µí•´ì•¼ í•  migration 3ë‹¨ê³„

1. `models.py`

   model ë³€ê²½ì‚¬í•­ ë°œìƒ ì‹œ

2. `$ python manage.py makemigrations`

   migrations íŒŒì¼ ìƒì„±

3. `$ python manage.py migrate`

   DB ë°˜ì˜(ëª¨ë¸ê³¼ DBì˜ ë™ê¸°í™”)

# Database API

* "DBë¥¼ ì¡°ì‘í•˜ê¸° ìœ„í•œ ë„êµ¬"
* Djangoê°€ ê¸°ë³¸ì ìœ¼ë¡œ ORMì„ ì œê³µí•¨ì— ë”°ë¥¸ ê²ƒìœ¼ë¡œ DBë¥¼ í¸í•˜ê²Œ ì¡°ì‘í•  ìˆ˜ ìˆë„ë¡ ë„ì›€
* Modelì„ ë§Œë“¤ë©´ DjangoëŠ” ê°ì²´ë“¤ì„ ë§Œë“¤ê³  ì½ê³  ìˆ˜ì •í•˜ê³  ì§€ìš¸ ìˆ˜ ìˆëŠ” database-abstract APIë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¦
* database-abstract API í˜¹ì€ database-access APIë¼ê³ ë„ í•¨
* [QuerySet API reference](https://docs.djangoproject.com/en/3.2/ref/models/querysets/)

## Making Queries

>  [í´ë˜ìŠ¤ëª…].objects.[ë©”ì„œë“œ]

![image-20220308134706955](image-20220308134706955.png)

## DB API

* Manager
  * Django ëª¨ë¸ì— ë°ì´í„°ë² ì´ìŠ¤ query ì‘ì—…ì´ ì œê³µë˜ëŠ” ì¸í„°í˜ì´ìŠ¤
  * ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  Django ëª¨ë¸ í´ë˜ìŠ¤ì— objects ë¼ëŠ” Manager ë¥¼ ì¶”ê°€
* QuerySet
  * ë°ì´í„°ë² ì´ìŠ¤ë¡œë¶€í„° ì „ë‹¬ë°›ì€ ê°ì²´ ëª©ë¡
  * queryset ì•ˆì— ê°ì²´ëŠ” 0ê°œ, 1ê°œ í˜¹ì€ ì—¬ëŸ¬ ê°œì¼ ìˆ˜ ìˆìŒ
  * ë°ì´í„°ë² ì´ìŠ¤ë¡œë¶€í„° ì¡°íšŒ, í•„í„°, ì •ë ¬ ë“±ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒ

## Django shell

* ì¼ë°˜ python shell ì„ í†µí•´ì„œëŠ” ì¥ê³  í”„ë¡œì íŠ¸ í™˜ê²½ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŒ
* ê·¸ë˜ì„œ ì¥ê³  í”„ë¡œì íŠ¸ ì„¤ì •ì´ loadëœ python shell ì„ í™œìš©í•´ DB API êµ¬ë¬¸ í…ŒìŠ¤íŠ¸ ì§„í–‰
* ê¸°ë³¸ Django shellë³´ë‹¤ ë” ë§ì€ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” shell_plusë¥¼ ì‚¬ìš©í•´ì„œ ì§„í–‰

1. ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

   ```bash
   $ pip install ipython
   $ pip install django-extensions
   ```

2. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“±ë¡ ë° ì‹¤í–‰

   ```python
   # settings.py
   INSTALLED_APPS = [
     ...,
     'django_extensions',
     ...,
   ]
   ```

   ```bash
   $ python manage.py shell_plus
   ```

# CRUDâ­

* ëŒ€ë¶€ë¶„ì˜ ì»´í“¨í„° ì†Œí”„íŠ¸ì›¨ì–´ê°€ ê°€ì§€ëŠ” ê¸°ë³¸ì ì¸ ë°ì´í„° ì²˜ë¦¬ ê¸°ëŠ¥ì¸ `Create, Read, Update, Delete` ë¥¼ ë¬¶ì–´ì„œ ì¼ì»«ëŠ” ë§ 

## CREATEâ­

```Python
# ë°©ë²• 1. ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í›„ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ ì„¤ì •
>>> article = Article()
>>> article.title = 'first'
>>> article.django = 'django!'
>>> article.save()

# ë°©ë²• 2. ì´ˆê¸° ê°’ê³¼ í•¨ê»˜ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
>>> article = Article(title='first', content='django!')
>>> article.save()

# ë°©ë²• 3. QuerySet API - create() ì‚¬ìš©
# ìœ„ 2ê°œ ë°©ì‹ê³¼ëŠ” ë‹¤ë¥´ê²Œ ë°”ë¡œ DB ì— ì €ì¥ë˜ë©° ì¿¼ë¦¬ í‘œí˜„ì‹ì„ ë¦¬í„´í•œë‹¤.
>>> Article.objects.create(title='first', content='django!')
```

1. ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„± í›„ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ ì„¤ì •
2. ì´ˆê¸° ê°’ê³¼ í•¨ê»˜ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
3. QuerySet API - create() ì‚¬ìš©

### `save()`  method

* Saving objects
* ê°ì²´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•¨
* ë°ì´í„° ìƒì„± ì‹œ save() ë¥¼ í˜¸ì¶œí•˜ê¸° ì „ì—ëŠ” ê°ì²´ì˜ ID ê°’ì´ ë¬´ì—‡ì¸ì§€ ì•Œ ìˆ˜ ì—†ìŒ
  * ID ê°’ì€ Django ê°€ ì•„ë‹ˆë¼ DBì—ì„œ ê³„ì‚°ë˜ê¸° ë•Œë¬¸
* **ë‹¨ìˆœíˆ ëª¨ë¸ì„ ì¸ìŠ¤í„´ìŠ¤í™” í•˜ëŠ” ê²ƒì€ DBì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë°˜ë“œì‹œ save() ê°€ í•„ìš”**
* `__str__` : print í˜¸ì¶œ ì‹œ ì¶œë ¥ë˜ëŠ” ë¬¸ìì—´, ì‘ì„± í›„ ë°˜ë“œì‹œ shell_plus ë¥¼ ì¬ì‹œì‘í•´ì•¼ ë°˜ì˜ëœë‹¤.



## READ

```python
# DBì— ì¸ìŠ¤í„´ìŠ¤ ê°ì²´ë¥¼ ì–»ê¸° ìœ„í•œ ì¿¼ë¦¬ë¬¸ ë‚ ë¦¬ê¸°
# ì´ë•Œ, ë ˆì½”ë“œê°€ í•˜ë‚˜ë§Œ ìˆìœ¼ë©´ ì¸ìŠ¤í„´ìŠ¤ ê°ì²´ê³ , ë‘ê°œ ì´ìƒì´ë©´ ì¿¼ë¦¬ì…‹ìœ¼ë¡œ ë¦¬í„´
>>> Ariticle.objects.all()
<QuerySet []>
```

### `all()`

* **í˜„ì¬ QuerySetì˜ ë³µì‚¬ë³¸ì„ ë°˜í™˜**

### `get()`

* ì£¼ì–´ì§„ lookup ë§¤ê°œë³€ìˆ˜ì™€ ì¼ì¹˜í•˜ëŠ” **ê°ì²´ë¥¼ ë°˜í™˜**
* ê°ì²´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìœ¼ë©´ DoesNotExist ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ê³ ,  ë‘˜ ì´ìƒì˜ ê°ì²´ë¥¼ ì°¾ìœ¼ë©´ MultipleObjectsReturned ì˜ˆì™¸ë¥¼ ë°œìƒ ì‹œí‚´
* ìœ„ì™€ ê°™ì€ íŠ¹ì§•ì„ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— **primary key ì™€ ê°™ì´ ê³ ìœ (unique)ì„±ì„ ë³´ì¥í•˜ëŠ” ì¡°íšŒì—ì„œ ì‚¬ìš©**í•´ì•¼ í•¨

```python
from django.shortcuts import render, get_object_or_404
stu = get_object_or_404(Student, pk=1)
```

### `filter()`

* ì£¼ì–´ì§„ lookup ë§¤ê°œë³€ìˆ˜ì™€ ì¼ì¹˜í•˜ëŠ” ê°ì²´ë¥¼ í¬í•¨í•˜ëŠ” **ìƒˆ QuerySetì„ ë°˜í™˜**

> â­ ê°ê°ì˜ ë¦¬í„´ë°›ëŠ” ê°’ í—·ê°ˆë¦¬ì§€ ì•Šë„ë¡ ì£¼ì˜



## UPDATEâ­

```python
>>> article = Article.objects.get(pk=1)
>>> article.title
'first'

>>> article.title = 'byebye'
>>> article.save()

>>> article.title
'byebye'
```

1. DBì—ì„œ ìˆ˜ì •í•  dataë¥¼ ê°€ì ¸ì˜¨ë‹¤.
2. ê°€ì ¸ì˜¨ ë°ì´í„°ì˜ ê°’ì„ ë³€ê²½í•œë‹¤.
3. save í•œë‹¤.



## DELETE

```python
>>> article = Article.objects.get(pk=1)
>>> article.delete()
>>> Article.objects.get(pk=1)
DoesNotExist: Article matching query does not exist.
```

### `delete()`

* QuerySet ì˜ ëª¨ë“  í–‰ì— ëŒ€í•´ SQL ì‚­ì œ ì¿¼ë¦¬ë¥¼ ìˆ˜í–‰í•˜ê³ , ì‚­ì œëœ ê°ì²´ ìˆ˜ì™€ ê°ì²´ ìœ í˜•ë‹¹ ì‚­ì œ ìˆ˜ê°€ í¬í•¨ëœ ë”•ì…”ë„ˆë¦¬ë¥¼ ë°˜í™˜



## Field lookups

* ì¡°íšŒ ì‹œ íŠ¹ì • ê²€ìƒ‰ ì¡°ê±´ì„ ì§€ì •
* QuerySet ë©”ì„œë“œ filter(), exclude() ë° get() ì— ëŒ€í•œ í‚¤ì›Œë“œ ì¸ìˆ˜ë¡œ ì§€ì •ë¨

```python
Article.objects.filter(pk__gt=2)
Article.objects.filter(content__contains='ja')
```



>ğŸ’¡ ë°ì´í„° ë² ì´ìŠ¤ ì¡°ì‘ì„ ìœ„í•œ ë‹¤ì–‘í•œ QuerySet API methods ëŠ” í•´ë‹¹ ê³µì‹ë¬¸ì„œë¥¼ ë°˜ë“œì‹œ ì°¸ê³ í•˜ì—¬ í•™ìŠµí•  ê²ƒ
>
>https://docs.djangoproject.com/en/3.2/ref/models/querysets/#

# Admin Site

## Automatic admin interface

* ì‚¬ìš©ìê°€ ì•„ë‹Œ ì„œë²„ì˜ ê´€ë¦¬ìê°€ í™œìš©í•˜ê¸° ìœ„í•œ í˜ì´ì§€
* Model class ë¥¼ admin.py ì— ë“±ë¡í•˜ê³  ê´€ë¦¬
* django.contrib.auth ëª¨ë“ˆì—ì„œ ì œê³µë¨
* record ìƒì„± ì—¬ë¶€ í™•ì¸ì— ë§¤ìš° ìœ ìš©í•˜ë©°, ì§ì ‘ recordë¥¼ ì‚½ì…í•  ìˆ˜ë„ ìˆìŒ

## admin ìƒì„±â­

```bash
$ python manage.py createsuperuser
```

* ê´€ë¦¬ì ê³„ì„± ìƒì„± í›„ ì„œë²„ë¥¼ ì‹¤í–‰í•œ ë‹¤ìŒ '/admin' ìœ¼ë¡œ ê°€ì„œ ê´€ë¦¬ì í˜ì´ì§€ ë¡œê·¸ì¸
  * ê³„ì •ë§Œ ë§Œë“  ê²½ìš° Django ê´€ë¦¬ì í™”ë©´ì—ì„œ ì•„ë¬´ê²ƒë„ ë³´ì´ì§€ ì•ŠìŒ
* ë‚´ê°€ ë§Œë“  Model ì„ ë³´ê¸° ìœ„í•´ì„œëŠ” admin.py ì— ì‘ì„±í•˜ì—¬ Django ì„œë²„ì— ë“±ë¡
* â—ï¸authì— ê´€ë ¨ëœ ê¸°ë³¸ í…Œì´ë¸”ì´ ìƒì„±ë˜ì§€ ì•Šìœ¼ë©´ ê´€ë¦¬ì ê³„ì •ì„ ìƒì„±í•  ìˆ˜ ì—†ìŒ

## admin ë“±ë¡

```python
# article/admin.py
from django.contrib import admin
from .models import Article

class ArticleAdmin(admin.ModelAdmin):
  list_display = ('pk', 'title', 'content', 'created_at', 'updated_at',)

# â­ admin siteì— register í•˜ê² ë‹¤.
admin.site.register(Article)
```

* admin.pyëŠ” ê´€ë¦¬ì ì‚¬ì´íŠ¸ì— Article ê°ì²´ê°€ ê´€ë¦¬ì ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°€ì§€ê³  ìˆë‹¤ëŠ” ê²ƒì„ ì•Œë ¤ì£¼ëŠ” ê²ƒ
* models.pyì— ì •ì˜í•œ `__str__` ì˜ í˜•íƒœë¡œ ê°ì²´ê°€ í‘œí˜„ë¨

* `list_display` : models.py ì •ì˜í•œ ê°ê°ì˜ ì†ì„±(ì¹¼ëŸ¼)ë“¤ì˜ ê°’(ë ˆì½”ë“œ)ì„ admin í˜ì´ì§€ì— ì¶œë ¥í•˜ë„ë¡ ì„¤ì •
